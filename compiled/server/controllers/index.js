'use strict';

var twitterUtil = require('../utility/util-twtr.js');
var havenUtil = require('../utility/util-haven.js');
var Promise = require('bluebird');

var getTweetsAsync = Promise.promisify(twitterUtil.getTweets, { context: twitterUtil, multiArgs: true });

module.exports = {
  getAnalysis: function getAnalysis(req, res, next) {
    // Using hardcoded twitter handle for testing purposes, default currently pulls 5 most recent tweets
    getTweetsAsync('TweetsByTutt').spread(function (data, response) {
      res.status(200).json(data);
    }).catch(function (err) {
      res.status(404).end();
    });
  },

  getRequestToken: function getRequestToken(req, res, next) {
    twitterUtil.getRequestToken(req, res);
  },

  getAccessToken: function getAccessToken(req, res, next) {
    // Receives callback that contains oAuth verifier
    // Pull verifier from query parameters
    // Send oAuth verifier through utility function and user promises to verify consumer keys
    var oAuthVerifier = req.query.oauth_verifier;
    twitterUtil.getAccessToken(req, res, oAuthVerifier);
  }

};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NlcnZlci9jb250cm9sbGVycy9pbmRleC5qcyJdLCJuYW1lcyI6WyJ0d2l0dGVyVXRpbCIsInJlcXVpcmUiLCJoYXZlblV0aWwiLCJQcm9taXNlIiwiZ2V0VHdlZXRzQXN5bmMiLCJwcm9taXNpZnkiLCJnZXRUd2VldHMiLCJjb250ZXh0IiwibXVsdGlBcmdzIiwibW9kdWxlIiwiZXhwb3J0cyIsImdldEFuYWx5c2lzIiwicmVxIiwicmVzIiwibmV4dCIsInNwcmVhZCIsImRhdGEiLCJyZXNwb25zZSIsInN0YXR1cyIsImpzb24iLCJjYXRjaCIsImVyciIsImVuZCIsImdldFJlcXVlc3RUb2tlbiIsImdldEFjY2Vzc1Rva2VuIiwib0F1dGhWZXJpZmllciIsInF1ZXJ5Iiwib2F1dGhfdmVyaWZpZXIiXSwibWFwcGluZ3MiOiI7O0FBQUEsSUFBSUEsY0FBY0MsUUFBUSx5QkFBUixDQUFsQjtBQUNBLElBQUlDLFlBQVlELFFBQVEsMEJBQVIsQ0FBaEI7QUFDQSxJQUFJRSxVQUFVRixRQUFRLFVBQVIsQ0FBZDs7QUFFQSxJQUFJRyxpQkFBaUJELFFBQVFFLFNBQVIsQ0FBa0JMLFlBQVlNLFNBQTlCLEVBQXlDLEVBQUNDLFNBQVNQLFdBQVYsRUFBdUJRLFdBQVcsSUFBbEMsRUFBekMsQ0FBckI7O0FBRUFDLE9BQU9DLE9BQVAsR0FBaUI7QUFDZkMsZUFBYSxxQkFBU0MsR0FBVCxFQUFjQyxHQUFkLEVBQW1CQyxJQUFuQixFQUF5QjtBQUNwQztBQUNBVixtQkFBZSxjQUFmLEVBQ0NXLE1BREQsQ0FDUSxVQUFDQyxJQUFELEVBQU9DLFFBQVAsRUFBb0I7QUFDMUJKLFVBQUlLLE1BQUosQ0FBVyxHQUFYLEVBQWdCQyxJQUFoQixDQUFxQkgsSUFBckI7QUFDRCxLQUhELEVBSUNJLEtBSkQsQ0FJTyxVQUFDQyxHQUFELEVBQVM7QUFDZFIsVUFBSUssTUFBSixDQUFXLEdBQVgsRUFBZ0JJLEdBQWhCO0FBQ0QsS0FORDtBQU9ELEdBVmM7O0FBWWZDLG1CQUFpQix5QkFBU1gsR0FBVCxFQUFjQyxHQUFkLEVBQW1CQyxJQUFuQixFQUF5QjtBQUN4Q2QsZ0JBQVl1QixlQUFaLENBQTRCWCxHQUE1QixFQUFpQ0MsR0FBakM7QUFDRCxHQWRjOztBQWdCZlcsa0JBQWdCLHdCQUFTWixHQUFULEVBQWNDLEdBQWQsRUFBbUJDLElBQW5CLEVBQXlCO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBLFFBQUlXLGdCQUFnQmIsSUFBSWMsS0FBSixDQUFVQyxjQUE5QjtBQUNBM0IsZ0JBQVl3QixjQUFaLENBQTJCWixHQUEzQixFQUFnQ0MsR0FBaEMsRUFBcUNZLGFBQXJDO0FBQ0Q7O0FBdEJjLENBQWpCIiwiZmlsZSI6ImluZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIHR3aXR0ZXJVdGlsID0gcmVxdWlyZSgnLi4vdXRpbGl0eS91dGlsLXR3dHIuanMnKTtcbnZhciBoYXZlblV0aWwgPSByZXF1aXJlKCcuLi91dGlsaXR5L3V0aWwtaGF2ZW4uanMnKTtcbnZhciBQcm9taXNlID0gcmVxdWlyZSgnYmx1ZWJpcmQnKTtcblxudmFyIGdldFR3ZWV0c0FzeW5jID0gUHJvbWlzZS5wcm9taXNpZnkodHdpdHRlclV0aWwuZ2V0VHdlZXRzLCB7Y29udGV4dDogdHdpdHRlclV0aWwsIG11bHRpQXJnczogdHJ1ZX0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgZ2V0QW5hbHlzaXM6IGZ1bmN0aW9uKHJlcSwgcmVzLCBuZXh0KSB7XG4gICAgLy8gVXNpbmcgaGFyZGNvZGVkIHR3aXR0ZXIgaGFuZGxlIGZvciB0ZXN0aW5nIHB1cnBvc2VzLCBkZWZhdWx0IGN1cnJlbnRseSBwdWxscyA1IG1vc3QgcmVjZW50IHR3ZWV0c1xuICAgIGdldFR3ZWV0c0FzeW5jKCdUd2VldHNCeVR1dHQnKVxuICAgIC5zcHJlYWQoKGRhdGEsIHJlc3BvbnNlKSA9PiB7XG4gICAgICByZXMuc3RhdHVzKDIwMCkuanNvbihkYXRhKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICByZXMuc3RhdHVzKDQwNCkuZW5kKCk7XG4gICAgfSk7XG4gIH0sXG5cbiAgZ2V0UmVxdWVzdFRva2VuOiBmdW5jdGlvbihyZXEsIHJlcywgbmV4dCkge1xuICAgIHR3aXR0ZXJVdGlsLmdldFJlcXVlc3RUb2tlbihyZXEsIHJlcyk7XG4gIH0sXG5cbiAgZ2V0QWNjZXNzVG9rZW46IGZ1bmN0aW9uKHJlcSwgcmVzLCBuZXh0KSB7XG4gICAgLy8gUmVjZWl2ZXMgY2FsbGJhY2sgdGhhdCBjb250YWlucyBvQXV0aCB2ZXJpZmllclxuICAgIC8vIFB1bGwgdmVyaWZpZXIgZnJvbSBxdWVyeSBwYXJhbWV0ZXJzXG4gICAgLy8gU2VuZCBvQXV0aCB2ZXJpZmllciB0aHJvdWdoIHV0aWxpdHkgZnVuY3Rpb24gYW5kIHVzZXIgcHJvbWlzZXMgdG8gdmVyaWZ5IGNvbnN1bWVyIGtleXNcbiAgICBsZXQgb0F1dGhWZXJpZmllciA9IHJlcS5xdWVyeS5vYXV0aF92ZXJpZmllcjtcbiAgICB0d2l0dGVyVXRpbC5nZXRBY2Nlc3NUb2tlbihyZXEsIHJlcywgb0F1dGhWZXJpZmllcik7XG4gIH1cblxufTsiXX0=